# Proto使用技巧

## 1. 优点
1. 可自动生成代码
2. 兼容GRPC，csingo 当前只支持 HTTP-RPC，后续会逐步升级支持GRPC协议
3. csingo 框架中提供了 **cProto** 包，用于扩展当前 proto 功能
  - enum 类型增加 **Desc** 以及 **Error** 方法，用于获取常量注释
  - message 字段增加类型替换功能，用于复杂数据结构的定义和替换
  - service 增加 http-rpc 服务端和客户端功能

## 2. 缺点
1. 需要提前编辑好 proto 文件才能自动生成代码

## 3. 使用示例

### 3.1 定义service

具体定义方法参考 [应用服务](/csingo/3%20基础功能/3.5%20应用服务.html) 章节

```
syntax = "proto3";
option go_package = "../demo";

package demo;

import "demo/Message.proto";

service HelloService {
    rpc Hello(HelloServiceHelloReq) returns (HelloServiceHelloRsp);
}
```

### 3.2 定义结构体

```
syntax = "proto3";
option go_package = "../demo";

package demo;

message HelloServiceHelloReq {
    string name = 1; // <type:[][]string>
}

message HelloServiceHelloRsp {
    string name = 1;
}

enum DemoError {
    DemoError_Nil = 0;
    DemoError_NotFound = 100001; // <error:不存在>
}

enum DemoName {
  DemoName_Default = 0; // <desc:default>
  DemoName_Demo = 1;    // <desc:demo>
}
```

**_&lt;type&gt;_** 用于重定义数据类型<br>
**_&lt;error&gt;_** 用于定义常量继承 **error** 接口，实现 **Error()** 方法<br>
**_&lt;desc&gt;_** 用于定义常量描述信息，实现 **Desc()** 方法<br>

### 3.2 生成代码


```
csingo app::service --app=demo [--protoPath=]
```

自动生成的代码存放在 **base/demo** 目录中，其中包含 HTTP-RPC 的服务端及客户端代码，以及 proto 结构体定义代码